{"version":3,"file":"index.js","sources":["../src/js/refs.js","../src/js/config.js","../src/js/news-service.js","../src/js/truncateText.js","../src/js/appendNewsArticles.js","../src/main.js"],"sourcesContent":["export const refs = {\n    form: document.querySelector(\".js-search-form\"),\n    container: document.querySelector(\".js-cards-container\"),\n    loadMoreBtn: document.querySelector(\".js-load-more\"),\n    loader: document.querySelector(\".js-loader\"),\n}","export const API_KEY = \"8f1159dd082647efb71a49f696ece6e7\";\nexport const BASE_URL = \"https://newsapi.org/v2/\";\nexport const PER_PAGE = 6;","import axios from \"axios\";\nimport { BASE_URL, API_KEY, PER_PAGE } from \"./config.js\";\n\nexport async function fetchNews(searchQuery, currentPage = 1) {\n    const options = new URLSearchParams({\n        q: searchQuery,\n        apiKey: API_KEY,\n        language: \"en\",\n        pageSize: PER_PAGE,\n        page: currentPage,\n    });\n    const url = `${BASE_URL}/everything?${options}`\n    const {data: {articles, totalResults, status, message = \"\"}} = await axios.get(url);\n    if (status !== \"ok\") {\n        throw new Error(message);\n    } \n    if (articles.length === 0) {\n        throw new Error(\"No articles found\");\n    }\n    return { articles, totalResults };\n}\n\n","export function truncate(text, symbolsLimit = 90) {\n    return text.length <= symbolsLimit ? text : `${text.slice(0, symbolsLimit - 3)}...`\n}","import { truncate } from \"./truncateText.js\";\n\nfunction timeAgo(dateString) {\n  const now = new Date();\n  const publishedDate = new Date(dateString);\n  const secondsAgo = Math.floor((now - publishedDate) / 1000);\n\n  const minutesAgo = Math.floor(secondsAgo / 60);\n  const hoursAgo = Math.floor(minutesAgo / 60);\n  const daysAgo = Math.floor(hoursAgo / 24);\n\n  if (daysAgo > 0) {\n    return `Last updated ${daysAgo} day${daysAgo > 1 ? 's' : ''} ago`;\n  } else if (hoursAgo > 0) {\n    return `Last updated ${hoursAgo} hour${hoursAgo > 1 ? 's' : ''} ago`;\n  } else if (minutesAgo > 0) {\n    return `Last updated ${minutesAgo} minute${minutesAgo > 1 ? 's' : ''} ago`;\n  } else {\n    return `Last updated just now`;\n  }\n}\n\nexport function appendNewsArticles(articles, wrapper) {\n    const filteredArticles = articles.filter(article => article.title !== \"[Removed]\" && article.urlToImage !== null)\n    const articlesMarkup =  filteredArticles.map(\n    ({title, description, url, urlToImage, publishedAt}) => `<article class=\"card\">\n        <img\n          class=\"card-img-top\"\n          src=\"${urlToImage ? urlToImage : 'https://placehold.co/600x400?text=Hot news'}\"\n          alt=\"${title}\"\n        />\n        <div class=\"card-body\">\n          <h5 class=\"card-title\">${truncate(title, 30)}</h5>\n          <p class=\"card-text\">\n            ${truncate(description)}\n          </p>\n          <p class=\"card-text\">\n            <small class=\"text-body-secondary\">${timeAgo(publishedAt)}</small>\n          </p>\n          <a href=\"${url}\" class=\"btn btn-outline-primary\" target=\"_blank\" rel=\"noopener noreferrer\" >Read more</a>\n        </div>\n      </article>`\n  ).join(\"\");\n  wrapper.insertAdjacentHTML(\"beforeend\", articlesMarkup)\n}","// fetch(\"https://jsonplaceholder.typicode.com/posts\").then(response => response.json()).then(json => {\n//     const ul = document.querySelector(\".posts-list\");\n   \n//       json.forEach((item, index) => {\n//         const post = document.createElement(\"li\");\n//         const postIndex = document.createElement(\"span\");\n//         const postTitle = document.createElement(\"h4\");\n//         const postText = document.createElement(\"p\");\n//         const link = document.createElement(\"a\");\n        \n//         post.classList.add(\"posts-list-item\");\n//         postIndex.classList.add(\"post-index\");\n//          postTitle.classList.add(\"post-title\");\n//         postText.classList.add(\"post-text\");\n//         link.classList.add(\"post-link\");\n\n//         postIndex.innerHTML = index + 1;\n//         postTitle.innerHTML = item.title;\n//         postText.innerHTML = item.body;\n//         link.innerHTML = \"Read more\";\n\n//         post.append(postIndex, postTitle, postText, link);\n//         ul.append(post);\n//     })\n// })\n\nimport axios from \"axios\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { refs } from \"./js/refs\";\nimport { fetchNews } from \"./js/news-service\";\nimport { appendNewsArticles } from \"./js/appendNewsArticles\";\nimport { PER_PAGE } from \"./js/config\";\n\n\ndocument.head.insertAdjacentHTML(\"beforeend\", `<link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n<link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin>\n<link href=\"https://fonts.googleapis.com/css2?family=Montserrat:ital@0;1&display=swap\" rel=\"stylesheet\"><link href=\"https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,500;1,500&display=swap\" rel=\"stylesheet\">`)\n\nlet currentPage = 1;\nlet searchQuery = null;\nlet pages = 0;\n\nrefs.form.addEventListener(\"submit\", handleSubmit);\nrefs.loadMoreBtn.addEventListener(\"click\", handleLoadMore);\n\nasync function handleSubmit(event) {\n  event.preventDefault();\n  const form = event.currentTarget;\n  searchQuery = form.elements.newsKeyword.value;\n  refs.loadMoreBtn.classList.add(\"is-hidden\");\n  refs.container.innerHTML = \"\";\n  currentPage = 1;\n\n  try {\n    const { articles, totalResults } = await fetchNews(searchQuery, currentPage);\n      if (currentPage === 1) {\n      iziToast.success({ message: 'First page ðŸ˜Ž'});\n    }\n\n    pages = Math.ceil(totalResults / PER_PAGE);\n    appendNewsArticles(articles, refs.container);\n    refs.loadMoreBtn.classList.remove(\"is-hidden\");\n  }\n  catch (error) {\n    refs.loadMoreBtn.classList.add(\"is-hidden\");\n     iziToast.error({\n      message: error.message\n    });\n  }\n  finally {\n    form.reset()\n  }\n}\n\nasync function handleLoadMore() {\n  currentPage += 1;\n  try {\n    refs.loader.classList.remove(\"is-hidden\");\n    const { articles, totalResults } = await fetchNews(searchQuery, currentPage);\n    appendNewsArticles(articles, refs.container);\n    handleScroll()\n\n    if (currentPage >= Math.min(pages, 16)) {\n    refs.loadMoreBtn.classList.add(\"is-hidden\");\n    return;\n    }\n  }\n  catch (error) {\n    console.log(error);\n  }\n  finally {\nrefs.loader.classList.add(\"is-hidden\");\n  }\n}\n\nfunction handleScroll() {\n  const lastArticle = refs.container.lastElementChild;\n  const articleHeight = lastArticle.getBoundingClientRect().height;\n  window.scrollBy({\n    top: articleHeight * 2,\n    left: 0,\n    behavior: \"smooth\",\n  });\n}\n"],"names":["refs","API_KEY","BASE_URL","PER_PAGE","fetchNews","searchQuery","currentPage","options","url","articles","totalResults","status","message","axios","truncate","text","symbolsLimit","timeAgo","dateString","now","publishedDate","secondsAgo","minutesAgo","hoursAgo","daysAgo","appendNewsArticles","wrapper","articlesMarkup","article","title","description","urlToImage","publishedAt","pages","handleSubmit","handleLoadMore","event","form","iziToast","error","handleScroll","articleHeight"],"mappings":"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"}